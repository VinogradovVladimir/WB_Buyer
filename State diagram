@startuml
skinparam state {
  BackgroundColor<<Пользователь>> LightYellow
  BackgroundColor<<Товарная позиция>> LightGreen 
  BackgroundColor<<Экземпляр товара>> LightBlue
  StartColor Red
  EndColor Red
}

[*]--> Не_авторизован <<Пользователь>> : [ПОЛЬЗОВАТЕЛЬ]
Не_авторизован --> Авторизован : Ввод и проверка \nномера телефона

state Авторизован <<Пользователь>>
Авторизован --> Ищет_товар : Поиск в каталоге/по ссылке

state Ищет_товар <<Пользователь>>
Ищет_товар --> Формирует_корзину : Добавление товара \nв корзину

state Формирует_корзину <<Пользователь>>
Формирует_корзину --> Редактирует_корзину : Изменение корзины
Формирует_корзину --> Оформляет_заказ : Подтверждение заказа
Формирует_корзину --> Ищет_товар : Найти ещё товар

state Редактирует_корзину <<Пользователь>>
Редактирует_корзину --> Оформляет_заказ : Подтверждение заказа

state Оформляет_заказ <<Пользователь>>
Оформляет_заказ --> Ожидает_доставку : Успешная оплата

state Ожидает_доставку <<Пользователь>>
Ожидает_доставку --> Получает_товар : Товар доставлен \nи получен

state Получает_товар <<Пользователь>>
Получает_товар --> [*] : товар подходит
Получает_товар --> Возвращает_товар <<Пользователь>> : товар не соответствует \nили не удовлетворяет заказу
Возвращает_товар --> [*] : Возврат средств клиенту

[*]--> Создана_форма_на_позицию <<Товарная позиция>> : [ТОВАРНАЯ ПОЗИЦИЯ]
Создана_форма_на_позицию --> Создана_позиция : Добавление информации

state Создана_позиция <<Товарная позиция>>  
Создана_позиция --> В_каталоге : Проверка и добавление

state В_каталоге <<Товарная позиция>>
В_каталоге --> В_корзине : Выбор покупателем

state В_корзине <<Товарная позиция>>
В_корзине --> В_заказе : Оформление заказа

state В_заказе <<Товарная позиция>>
В_заказе --> Оплачена_клиентом : Подтверждение оплаты
В_корзине --> В_каталоге : Убран из корзины

state Оплачена_клиентом <<Товарная позиция>>
Оплачена_клиентом --> Заказ_в_магазине : Оплата в магазине

state Заказ_в_магазине <<Товарная позиция>>
Заказ_в_магазине --> В_доставке : Начало транспортировки

state В_доставке <<Товарная позиция>> 
В_доставке --> Доставлена <<Товарная позиция>>  : Получение покупателем
В_доставке --> Возвращена<<Товарная позиция>>   : Обнаружено несоответствие \nили повреждение
Возвращена --> [*] 
Доставлена --> [*]  

[*]-->В_магазине <<Экземпляр товара>> : [ЭКЗЕМПЛЯР ТОВАРА]
В_магазине --> В_пути_до_партнёра : Подтверждение заказа

state В_пути_до_партнёра <<Экземпляр товара>>
В_пути_до_партнёра --> Принят_партнёром : Транспортировка заказа

state Принят_партнёром <<Экземпляр товара>>
Принят_партнёром --> Проверен_партнёром : Проверка дефектов состояния

state Проверен_партнёром <<Экземпляр товара>>
Проверен_партнёром --> В_пути_до_РФ : Транспортировка заказа

state В_пути_до_РФ <<Экземпляр товара>>
В_пути_до_РФ --> Принят_сотрудниками_WB : Доставка в контейнере

state Принят_сотрудниками_WB <<Экземпляр товара>>
Принят_сотрудниками_WB --> В_пути_до_магазина_отправителя : обнаружен дефект
Принят_сотрудниками_WB --> В_доставке_до_пункта_выдачи : дефектов нет

state В_доставке_до_пункта_выдачи <<Экземпляр товара>>
В_доставке_до_пункта_выдачи --> В_пункте_выдачи : Доставка в пункт выдачи

state В_пункте_выдачи <<Экземпляр товара>>
В_пункте_выдачи --> Выдан_покупателю : Получение товара покупателю
В_пункте_выдачи --> [*]

state В_пути_до_магазина_отправителя <<Экземпляр товара>>
В_пути_до_магазина_отправителя --> Возвращен_продавцу <<Экземпляр товара>> : Возврат продавцу
В_пути_до_магазина_отправителя --> [*]

state Выдан_покупателю <<Экземпляр товара>>
Выдан_покупателю --> [*]

@enduml

