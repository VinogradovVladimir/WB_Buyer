@startuml
skinparam backgroundColor #FFAAAA

' Дорожки
|Пользователь|
|Система|
|Компании_Партнёры|
|Логисты_WB|
|Сотрудник_Пункта_выдачи|

' Начало
|Пользователь|
start
:Авторизация;

|Система|
:Успешно?;
if (Да?) then (Да)
  |Пользователь|
  :Поиск товара;
else (Нет)
  -> :Авторизация;
endif

|Пользователь|
:Выбор: В каталоге или по ссылке?;
if (По ссылке?) then (По ссылке)
  |Пользователь|
  :Ввод ссылки;
  |Система|
  :Ссылка корректна?;
  if (Да?) then (Да)
    -> :Выбор товара;
  else (Нет)
    |Система|
    :Уведомление "Ссылка не корректна";
    -> :Ввод ссылки;
  endif
else (В каталоге?) then (В каталоге)
  |Пользователь|
  :Ввод ключевых слов в каталоге;
  |Система|
  :Показ результатов;
  |Пользователь|
  :Выбрать фильтры?;
  if (Да?) then (Да)
    |Пользователь|
    :Установка фильтров;
    |Система|
    :Фильтрация каталога;
    -> :Выбор товара;
  else (Нет)
    -> :Выбор товара;
  endif
endif

|Пользователь|
:Выбор товара;
:Товар найден?;
if (Да?) then (Да)
  |Система|
  :Показ страницы товара;
else (Нет)
  -> :Выбор товара;
endif

|Пользователь|
:Добавить товар в корзину?;
if (Да?) then (Да)
  |Система|
  :Добавление в корзину;
  |Пользователь|
  :Перейти в корзину?;
  if (Да?) then (Да)
    |Система|
    :Подсчёт стоимости товаров;
  else (Нет)
    -> :Выбор товара;
  endif
else (Нет)
  -> :Выбор товара;
endif

|Пользователь|
:Просмотр корзины;
:Редактировать корзину?;
if (Да?) then (Да)
  |Пользователь|
  :Редактирование содержания корзины;
  |Система|
  :Изменение корзины;
  -> :Просмотр корзины;
else (Нет)
  |Пользователь|
  :Оформить заказ?;
  if (Да?) then (Да)
    |Система|
    :Показ страницы оформления заказа;
  else (Нет)
    -> :Просмотр корзины;
  endif
endif

|Пользователь|
:Ввод данных для доставки и оплаты;
|Система|
:Обработка информации;
:Запись в базу данных;

|Пользователь|
:Оплата заказа;
|Система|
:Конвертация валют;
:Оформление заказа;

|Компании_Партнёры|
:Указание адреса для доставки;
:Оплата товара;
:Приём товара;
:Проверка товара;
if (Товар соответствует заказу и не поврежден?) then (Да)
  |Компании_Партнёры|
  :Группировка товаров;
  :Доставка до РФ;
  |Логисты_WB|
  :Приём товара;
  :Проверка товара;
  if (Товар соответствует заказу и не поврежден?) then (Да)
    |Логисты_WB|
    :Доставить до пункта выдачи;
    |Сотрудник_Пункта_выдачи|
    :Приём товара;
    |Система|
    :Уведомление покупателя - "Товар доставлен";
    |Пользователь|
    :Показ QR-кода;
    |Система|
    :QR верен?;
    if (Да?) then (Да)
      |Сотрудник_Пункта_выдачи|
      :Выдача товара;
      |Система|
      :Закрытие заказа (завершение процесса);
    else (Нет)
      |Система|
      :Оформление возврата товара в магазин;
      :Товар можно заказать заново?;
      if (Да?) then (Да)
        -> :Поиск товара;
      else (Нет)
        |Система|
        :Уведомление клиента;
        :Возврат средств покупателю;
        :Закрытие заказа (завершение процесса);
      endif
    endif
  else (Нет)
    |Система|
    :Оформление возврата товара в магазин;
    :Товар можно заказать заново?;
    if (Да?) then (Да)
      -> :Поиск товара;
    else (Нет)
      |Система|
      :Уведомление клиента;
      :Возврат средств покупателю;
      :Закрытие заказа (завершение процесса);
    endif
  endif
else (Нет)
  |Система|
  :Оформление возврата товара в магазин;
  :Товар можно заказать заново?;
  if (Да?) then (Да)
    -> :Поиск товара;
  else (Нет)
    |Система|
    :Уведомление клиента;
    :Возврат средств покупателю;
    :Закрытие заказа (завершение процесса);
  endif
endif

stop
@enduml
